# colors defined in ~/.bash_colors

# cpu info
CPU_MODEL=`cat /proc/cpuinfo | grep 'model name' | uniq | sed -E 's/^.+\: //'`
CPU_CORES=`cat /proc/cpuinfo | grep 'cpu cores' | uniq | sed -E 's/^.+\: //'`
CPU_THREADS=`cat /proc/cpuinfo | grep 'processor' | uniq | wc -l`

# memory info
MEMORY_BYTES=`lsmem -b | grep 'online memory' | sed -E 's/^.+\: //'`
MEMORY_MB=$(( $MEMORY_BYTES / 1024 / 1024 ))
MEMORY_GB=$(( $MEMORY_MB / 1024 ))

system_info() {
    echo -e "${bold}${white}CPU:${reset}     ${CPU_MODEL}"
    echo -e "${bold}${white}Threads:${reset} ${CPU_CORES}c / ${CPU_THREADS}t"

    echo -e "${bold}${white}Memory:${reset}  ${MEMORY_GB} GB (${MEMORY_MB} MB)"

    echo -e "${bold}${white}GPU:${reset}"
    list_gpus | sed -E 's/^/  /'
}

session_info() {
    echo -e "${bold}${blue}New Session${reset}"
    echo -e "${bold}${white}Started At:${reset} $(iso_datetime)"
    echo -e "${bold}${white}Internal IP:${reset} $(internal_ip)"
    echo -e "${bold}${white}External IP:${reset} $(external_ip)"
}

# TODO: dual mode welcome: system+session info on first command, session only on reload
# system_info | sed -E 's/^/    /'
session_info
